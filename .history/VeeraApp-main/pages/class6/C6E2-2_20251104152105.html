<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class 6 - Perishable Goods Monitoring System</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* Base Styles and Utility Replacements */
        body {
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            margin: 0;
            padding: 0;
        }

        /* Basic Icon Placeholder Styles (Replacing lucide-react) */
        .icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            vertical-align: middle;
            stroke-width: 2.5;
            line-height: 1;
        }

        .icon-home::before {
            content: 'üè†';
            font-size: 20px;
        }

        .icon-arrow-left::before {
            content: '‚Üê';
            font-size: 20px;
        }

        .icon-grid3x3::before {
            content: 'üéõÔ∏è';
            font-size: 20px;
        }

        .icon-thermometer::before {
            content: 'üå°Ô∏è';
            font-size: 24px;
        }

        .icon-refrigerator::before {
            content: 'üßä';
            font-size: 24px;
        }

        .icon-trending-up::before {
            content: '‚ñ≤';
            font-size: 16px;
        }

        .icon-trending-down::before {
            content: '‚ñº';
            font-size: 16px;
        }

        .icon-award::before {
            content: 'üèÜ';
            font-size: 20px;
        }

        .icon-zap::before {
            content: '‚ö°';
            font-size: 20px;
        }

        /* Custom styles for animation placeholders */
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: .5;
            }
        }

        .animate-bounce {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(-25%);
                animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
            }

            50% {
                transform: translateY(0);
                animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
            }
        }
    </style>
</head>

<body>
    <div id="app-root" class="min-h-screen bg-gradient-to-b from-blue-50 to-blue-100 p-4">
        <audio id="voiceover-audio" src="perishable-goods-voiceover.mp3"></audio>

        <div class="bg-white rounded-lg shadow-md p-4 mb-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold text-blue-800">
                        Class 6 - Perishable Goods Monitoring System
                    </h1>
                    <p class="text-sm text-gray-600 mt-1">Control the temperature and keep all food fresh!</p>
                </div>
                <div class="flex gap-2">
                    <button id="prev-btn"
                        class="w-10 h-10 bg-yellow-400 hover:bg-yellow-500 rounded-full flex items-center justify-center transition-colors"
                        title="Previous Page">
                        <i class="icon icon-arrow-left w-5 h-5 text-white"></i>
                    </button>
                    <button id="home-btn"
                        class="w-10 h-10 bg-green-400 hover:bg-green-500 rounded-full flex items-center justify-center transition-colors"
                        title="Home">
                        <i class="icon icon-home w-5 h-5 text-white"></i>
                    </button>
                    <button id="levels-btn"
                        class="w-10 h-10 bg-purple-400 hover:bg-purple-500 rounded-full flex items-center justify-center transition-colors"
                        title="Levels">
                        <i class="icon icon-grid3x3 w-5 h-5 text-white"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-12 gap-4 mb-4">
            <div class="col-span-2 space-y-4">
                <div class="bg-white rounded-lg shadow-md p-4">
                    <div class="text-center mb-2">
                        <h3 class="font-semibold text-sm text-gray-700">Veera Kit</h3>
                        <p class="text-xs text-gray-500">Temperature Sensor</p>
                    </div>
                    <div class="bg-blue-100 rounded-lg p-4 border-2 border-blue-300">
                        <i class="icon icon-thermometer w-16 h-16 mx-auto text-red-500 animate-pulse"></i>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-4">
                    <div class="text-center">
                        <i class="icon icon-award w-8 h-8 mx-auto mb-2 text-yellow-500"></i>
                        <div id="score-display" class="text-2xl font-bold text-gray-800">100</div>
                        <div class="text-xs text-gray-600">Score</div>
                        <div class="text-xs text-gray-500 mt-2">‚è±Ô∏è <span id="time-display">0:00</span></div>
                        <button id="reset-game-btn"
                            class="mt-2 w-full bg-orange-400 hover:bg-orange-500 text-white text-xs font-semibold py-1 px-2 rounded transition-colors">
                            Reset Game
                        </button>
                    </div>
                </div>
            </div>

            <div class="col-span-7 bg-white rounded-lg shadow-md p-6 relative">
                <div id="feedback-message"
                    class="hidden absolute top-4 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-80 text-white px-6 py-3 rounded-full z-10 animate-pulse">
                </div>

                <div class="text-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">üè™ Fresh Market Refrigerator</h2>
                    <div id="freshness-level-display"
                        class="inline-block mt-2 px-4 py-2 rounded-full font-bold bg-yellow-200 text-yellow-800">
                        üå°Ô∏è Temperature Rising...
                    </div>
                </div>

                <div id="refrigerator-display"
                    class="relative border-4 rounded-xl p-6 transition-all duration-500 border-yellow-400 bg-gradient-to-b from-yellow-50 to-orange-100">

                    <div class="absolute top-2 right-2">
                        <i id="refrigerator-icon" class="icon icon-refrigerator w-12 h-12 text-blue-500"></i>
                    </div>

                    <div id="grocery-grid" class="grid grid-cols-3 gap-4">
                    </div>

                    <div class="mt-4 text-center">
                        <div id="temp-effect-message" class="text-yellow-600 font-bold">üå°Ô∏è Temperature Rising...</div>
                    </div>
                </div>
            </div>

            <div class="col-span-3 space-y-4">
                <!-- <div class="bg-white rounded-lg shadow-md p-4">
                    <div class="text-center mb-2">
                        <h3 class="font-semibold text-gray-700">Veera Guide</h3>
                    </div>
                    <img src="lion.gif" alt="Veera Avatar" class="w-full rounded-lg" />
                    <div class="mt-3 bg-blue-50 rounded-lg p-3">
                        <p class="text-xs text-gray-700 text-center">
                            "Keep the temperature low to preserve food and maintain your score!"
                        </p>
                    </div>
                </div> -->

                <div
                    class="bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg shadow-md p-4 border-2 border-purple-300">
                    <h3 class="font-semibold text-gray-700 mb-3 text-center flex items-center justify-center gap-2">
                        <i class="icon icon-zap w-5 h-5 text-purple-600"></i>
                        Control Temperature
                    </h3>

                    <div class="bg-white rounded-lg p-4 mb-3 text-center">
                        <i id="control-thermometer-icon"
                            class="icon icon-thermometer w-10 h-10 mx-auto mb-2 text-blue-500"></i>
                        <div id="temp-display" class="text-4xl font-bold text-gray-800">
                            22.0¬∞C
                        </div>
                        <div class="text-xs text-gray-600 mt-1">Current Temperature</div>
                    </div>

                    <div class="grid grid-cols-2 gap-2 mb-3">
                        <button id="adjust-down-btn"
                            class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-lg transition-colors flex items-center justify-center gap-1">
                            <i class="icon icon-trending-down w-4 h-4"></i>
                            -2¬∞C
                        </button>
                        <button id="adjust-up-btn"
                            class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 rounded-lg transition-colors flex items-center justify-center gap-1">
                            <i class="icon icon-trending-up w-4 h-4"></i>
                            +2¬∞C
                        </button>
                    </div>

                    <div class="space-y-2">
                        <input type="number" value="22" id="manual-temp-input"
                            class="w-full px-3 py-2 border-2 border-purple-300 rounded-lg focus:border-purple-500 focus:outline-none text-center font-bold"
                            placeholder="Set temp" />
                        <button id="apply-temp-btn"
                            class="w-full bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 rounded-lg transition-colors">
                            Apply Temperature
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-4">
                    <h3 class="font-semibold text-gray-700 mb-3 text-center">
                        Sensor Reading
                    </h3>
                    <div class="bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg p-4 border-2 border-gray-300">
                        <div class="text-center">
                            <div id="sensor-temp-display" class="text-2xl font-bold text-gray-800">
                                22.0¬∞C
                            </div>
                            <div class="text-xs text-gray-600 mt-1">From Veera Kit</div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-4">
                    <h3 class="font-semibold text-gray-700 mb-3 text-center">
                        Threshold Settings
                    </h3>
                    <div class="space-y-3">
                        <div>
                            <label class="text-xs text-gray-600 block mb-1">
                                Max Safe Temperature (¬∞C)
                            </label>
                            <input type="number" value="8" id="threshold-input"
                                class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                                placeholder="Enter threshold" />
                        </div>
                        <div class="text-center bg-gray-100 rounded-lg p-2">
                            <p class="text-sm text-gray-700">
                                Current: <span id="current-threshold-display" class="font-bold text-blue-600">8¬∞C</span>
                            </p>
                        </div>
                        <div class="flex gap-2">
                            <button id="set-threshold-btn"
                                class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 rounded-lg transition-colors">
                                Set
                            </button>
                            <button id="reset-threshold-btn"
                                class="flex-1 bg-gray-400 hover:bg-gray-500 text-white font-semibold py-2 rounded-lg transition-colors">
                                Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center">
            <button id="next-experiment-btn" onclick="goNext()"
                class="bg-gradient-to-r from-green-400 to-blue-500 hover:from-green-500 hover:to-blue-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all transform hover:scale-105">
                Next Experiment ‚Üí
            </button>
            <!-- <button class="continue-btn" onclick="goNext()">
                CONTINUE <img src="../../assets/icons/arrow.png" alt="Arrow">
            </button> -->
        </div>
    </div>

    <script>
        // --- STATE VARIABLES ---
        let temperature = 22;
        let sensorTemperature = 22;
        let threshold = 8;
        let thresholdInputVal = '8';
        let manualTempVal = '22';
        let isManualControl = false;
        let score = 100;
        let timeElapsed = 0;
        let gameStarted = false;
        let spoiledItems = [];
        let showFeedback = '';
        let sensorIntervalId = null;
        let timerIntervalId = null;
        let feedbackTimeoutId = null;

        // --- DOM ELEMENTS (Cached) ---
        const audioEl = document.getElementById('voiceover-audio');
        const scoreDisplayEl = document.getElementById('score-display');
        const timeDisplayEl = document.getElementById('time-display');
        const tempDisplayEl = document.getElementById('temp-display');
        const sensorTempDisplayEl = document.getElementById('sensor-temp-display');
        const currentThresholdDisplayEl = document.getElementById('current-threshold-display');
        const thresholdInputEl = document.getElementById('threshold-input');
        const manualTempInputEl = document.getElementById('manual-temp-input');
        const freshnessLevelDisplayEl = document.getElementById('freshness-level-display');
        const refrigeratorDisplayEl = document.getElementById('refrigerator-display');
        const refrigeratorIconEl = document.getElementById('refrigerator-icon');
        const controlThermometerIconEl = document.getElementById('control-thermometer-icon');
        const tempEffectMessageEl = document.getElementById('temp-effect-message');
        const feedbackMessageEl = document.getElementById('feedback-message');
        const groceryGridEl = document.getElementById('grocery-grid');

        // Buttons
        const resetGameBtn = document.getElementById('reset-game-btn');
        const setThresholdBtn = document.getElementById('set-threshold-btn');
        const resetThresholdBtn = document.getElementById('reset-threshold-btn');
        const adjustDownBtn = document.getElementById('adjust-down-btn');
        const adjustUpBtn = document.getElementById('adjust-up-btn');
        const applyTempBtn = document.getElementById('apply-temp-btn');

        // --- DATA ---
        const groceryItems = [
            { id: 'milk', name: 'Milk', optimalTemp: 4, spoilTemp: 10, freshImg: 'https://images.unsplash.com/photo-1550583724-b2692b85b150?w=200&h=200&fit=crop', spoiledImg: 'https://images.unsplash.com/photo-1628088062854-d1870b4553da?w=200&h=200&fit=crop' },
            { id: 'fish', name: 'Fresh Fish', optimalTemp: 2, spoilTemp: 8, freshImg: 'https://images.unsplash.com/photo-1615141982883-c7ad0e69fd62?w=200&h=200&fit=crop', spoiledImg: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=200&h=200&fit=crop' },
            { id: 'meat', name: 'Raw Meat', optimalTemp: 3, spoilTemp: 7, freshImg: 'https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=200&h=200&fit=crop', spoiledImg: 'https://images.unsplash.com/photo-1560717845-968905817848?w=200&h=200&fit=crop' },
            { id: 'cheese', name: 'Cheese', optimalTemp: 5, spoilTemp: 12, freshImg: 'https://images.unsplash.com/photo-1452195100486-9cc805987862?w=200&h=200&fit=crop', spoiledImg: 'https://images.unsplash.com/photo-1486297678162-eb2a19b0a32d?w=200&h=200&fit=crop' },
            { id: 'vegetables', name: 'Vegetables', optimalTemp: 6, spoilTemp: 15, freshImg: 'https://images.unsplash.com/photo-1540420773420-3366772f4999?w=200&h=200&fit=crop', spoiledImg: 'https://images.unsplash.com/photo-1615485290382-441e4d049cb5?w=200&h=200&fit=crop' },
            { id: 'eggs', name: 'Eggs', optimalTemp: 4, spoilTemp: 13, freshImg: 'https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?w=200&h=200&fit=crop', spoiledImg: 'https://images.unsplash.com/photo-1616680214084-22670e2f336a?w=200&h=200&fit=crop' },
        ];

        // --- GAME LOGIC FUNCTIONS ---

        const getFreshnessLevel = (temp) => {
            if (temp <= 5) return 'excellent';
            if (temp <= 8) return 'good';
            if (temp <= 12) return 'warning';
            return 'danger';
        };

        const showTemporaryFeedback = (message) => {
            clearTimeout(feedbackTimeoutId);
            feedbackMessageEl.textContent = message;
            feedbackMessageEl.classList.remove('hidden');
            feedbackTimeoutId = setTimeout(() => {
                feedbackMessageEl.classList.add('hidden');
            }, 2000);
        };

        const formatTime = (seconds) => {
            const min = Math.floor(seconds / 60);
            const sec = (seconds % 60).toString().padStart(2, '0');
            return `${min}:${sec}`;
        };

        const renderGroceryGrid = () => {
            let html = '';
            groceryItems.forEach(item => {
                const isSpoiled = spoiledItems.includes(item.id) || temperature > item.spoilTemp;
                const isOptimal = temperature <= item.optimalTemp;

                let borderClass = 'border-yellow-400 bg-yellow-50';
                if (isSpoiled) {
                    borderClass = 'border-red-400 bg-red-50';
                } else if (isOptimal) {
                    borderClass = 'border-green-400 bg-green-50';
                }

                html += `
                  <div
                    id="item-${item.id}"
                    class="relative p-3 rounded-lg border-3 transition-all ${borderClass}"
                  >
                    <div class="relative mb-2 rounded-lg overflow-hidden aspect-square">
                      <img 
                        src="${isSpoiled ? item.spoiledImg : item.freshImg}"
                        alt="${item.name}"
                        class="w-full h-full object-cover"
                      />
                      ${isSpoiled ? `
                        <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center">
                          <span class="text-4xl">ü¶†</span>
                        </div>
                      ` : ''}
                      ${isOptimal && !isSpoiled ? `
                        <div class="absolute top-1 right-1 bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">
                          ‚úì
                        </div>
                      ` : ''}
                    </div>
                    
                    <p class="text-center font-semibold text-sm">${item.name}</p>
                    <div class="text-center text-xs mt-1">
                      <div class="text-gray-600">Optimal: ${item.optimalTemp}¬∞C</div>
                      <div class="text-red-600">Spoils: ${item.spoilTemp}¬∞C</div>
                    </div>
                    
                    </div>
                `;
            });
            groceryGridEl.innerHTML = html;
        };

        const updateRefrigerationUI = (freshnessLevel) => {
            // Refrigerator Display Colors
            const colorMap = {
                'excellent': 'border-green-400 bg-gradient-to-b from-blue-100 to-cyan-100',
                'good': 'border-blue-400 bg-gradient-to-b from-blue-50 to-blue-100',
                'warning': 'border-yellow-400 bg-gradient-to-b from-yellow-50 to-orange-100',
                'danger': 'border-red-400 bg-gradient-to-b from-red-100 to-orange-100'
            };

            // Freshness Message
            const messageMap = {
                'excellent': '‚ùÑÔ∏è PERFECT CONDITIONS',
                'good': '‚úÖ GOOD STORAGE',
                'warning': '‚ö†Ô∏è GETTING WARM',
                'danger': 'üî• DANGER ZONE!'
            };

            // Temperature Effect Message
            if (temperature <= 5) {
                tempEffectMessageEl.className = 'text-blue-600 font-bold';
                tempEffectMessageEl.textContent = '‚ùÑÔ∏è ‚ùÑÔ∏è ‚ùÑÔ∏è Perfectly Chilled ‚ùÑÔ∏è ‚ùÑÔ∏è ‚ùÑÔ∏è';
            } else if (temperature <= 12) {
                tempEffectMessageEl.className = 'text-yellow-600 font-bold';
                tempEffectMessageEl.textContent = 'üå°Ô∏è Temperature Rising...';
            } else {
                tempEffectMessageEl.className = 'text-red-600 font-bold animate-pulse';
                tempEffectMessageEl.textContent = 'üî• ü¶† Bacteria Multiplying! ü¶† üî•';
            }

            // Apply Classes
            refrigeratorDisplayEl.className = `relative border-4 rounded-xl p-6 transition-all duration-500 ${colorMap[freshnessLevel]}`;
            freshnessLevelDisplayEl.className = `inline-block mt-2 px-4 py-2 rounded-full font-bold bg-${freshnessLevel.split('-')[0]}-200 text-${freshnessLevel.split('-')[0]}-800`;
            freshnessLevelDisplayEl.textContent = messageMap[freshnessLevel];

            // Icon animation/color
            refrigeratorIconEl.classList.toggle('text-red-500', freshnessLevel === 'danger');
            refrigeratorIconEl.classList.toggle('animate-bounce', freshnessLevel === 'danger');
            refrigeratorIconEl.classList.toggle('text-blue-500', freshnessLevel !== 'danger');

            controlThermometerIconEl.classList.toggle('text-red-500', temperature > 12);
            controlThermometerIconEl.classList.toggle('animate-pulse', temperature > 12);
            controlThermometerIconEl.classList.toggle('text-blue-500', temperature <= 12);
        };

        function goNext() { window.location.href = "C6E3.html"; }

        const updateUI = () => {
            const freshnessLevel = getFreshnessLevel(temperature);

            // Update state-dependent DOM elements
            scoreDisplayEl.textContent = score;
            timeDisplayEl.textContent = formatTime(timeElapsed);
            tempDisplayEl.textContent = `${temperature.toFixed(1)}¬∞C`;
            sensorTempDisplayEl.textContent = `${sensorTemperature.toFixed(1)}¬∞C`;
            currentThresholdDisplayEl.textContent = `${threshold}¬∞C`;
            thresholdInputEl.value = thresholdInputVal;
            manualTempInputEl.value = manualTempVal;

            // Render dynamic components
            renderGroceryGrid();
            updateRefrigerationUI(freshnessLevel);
        };

        const checkSpoilageAndUpdateScore = () => {
            if (!gameStarted) return;

            const newSpoiled = [];
            let scoreChange = 0;

            groceryItems.forEach(item => {
                const isCurrentlySpoiled = temperature > item.spoilTemp;

                if (isCurrentlySpoiled && !spoiledItems.includes(item.id)) {
                    newSpoiled.push(item.id);
                    scoreChange -= 15;
                    showTemporaryFeedback(`‚ùå ${item.name} is spoiling!`);
                } else if (temperature <= item.optimalTemp && !spoiledItems.includes(item.id)) {
                    // Small bonus for keeping things at optimal temp
                    if (Math.random() > 0.98) { // Make the bonus very rare
                        scoreChange += 1;
                    }
                }
            });

            if (newSpoiled.length > 0) {
                spoiledItems = [...spoiledItems, ...newSpoiled];
            }

            score = Math.max(0, score + scoreChange);
            updateUI();
        };

        // --- HANDLERS (Mapped from React component methods) ---

        const handleSetThreshold = () => {
            const value = parseFloat(thresholdInputEl.value);
            if (!isNaN(value) && value >= 0 && value <= 50) {
                threshold = value;
                thresholdInputVal = value.toString();
                showTemporaryFeedback('‚úÖ Threshold updated!');
            } else {
                alert('Please enter a valid temperature between 0 and 50¬∞C');
            }
            updateUI();
        };

        const handleResetThreshold = () => {
            threshold = 8;
            thresholdInputVal = '8';
            showTemporaryFeedback('üîÑ Threshold reset to 8¬∞C');
            updateUI();
        };

        const adjustTemperature = (delta) => {
            const newTemp = Math.max(-10, Math.min(40, temperature + delta));
            temperature = newTemp;
            manualTempVal = newTemp.toFixed(0);
            isManualControl = true;
            if (!gameStarted) startGame();
            updateUI();
        };

        const handleManualTempChange = () => {
            const value = parseFloat(manualTempInputEl.value);
            if (!isNaN(value) && value >= -10 && value <= 40) {
                temperature = value;
                manualTempVal = value.toString();
                isManualControl = true;
                if (!gameStarted) startGame();
            } else {
                alert('Please enter a valid temperature between -10 and 40¬∞C');
            }
            updateUI();
        };

        const resetGame = () => {
            score = 100;
            timeElapsed = 0;
            spoiledItems = [];
            gameStarted = false;
            temperature = 22;
            sensorTemperature = 22;
            manualTempVal = '22';
            isManualControl = false;

            clearInterval(sensorIntervalId);
            clearInterval(timerIntervalId);
            startSensorSimulation();

            showTemporaryFeedback('üéÆ Game Reset!');
            updateUI();
        };

        const startGame = () => {
            gameStarted = true;
            startTimer();
        }

        // --- SIMULATION/EFFECTS (Equivalent to useEffects) ---

        const startSensorSimulation = () => {
            clearInterval(sensorIntervalId); // Clear any existing interval
            sensorIntervalId = setInterval(() => {
                if (!isManualControl) {
                    // Random temperature fluctuation
                    const change = (Math.random() - 0.5) * 2;
                    sensorTemperature = Math.max(0, Math.min(35, sensorTemperature + change));
                    temperature = sensorTemperature;
                }

                // Check spoilage on every sensor update
                checkSpoilageAndUpdateScore();
            }, 2000); // Update every 2 seconds
        };

        const startTimer = () => {
            clearInterval(timerIntervalId);
            timerIntervalId = setInterval(() => {
                if (gameStarted) {
                    timeElapsed++;
                    updateUI();
                } else {
                    clearInterval(timerIntervalId);
                }
            }, 1000); // Update every 1 second
        };

        // --- INITIALIZATION ---

        document.addEventListener('DOMContentLoaded', () => {
            // 1. Initial Voiceover Play
            if (audioEl) {
                audioEl.play().catch(err => console.log('Audio play failed:', err));
            }

            // 2. Start Sensor Simulation
            startSensorSimulation();

            // 3. Attach Event Listeners
            setThresholdBtn.addEventListener('click', handleSetThreshold);
            resetThresholdBtn.addEventListener('click', handleResetThreshold);
            resetGameBtn.addEventListener('click', resetGame);
            adjustDownBtn.addEventListener('click', () => adjustTemperature(-2));
            adjustUpBtn.addEventListener('click', () => adjustTemperature(2));
            applyTempBtn.addEventListener('click', handleManualTempChange);
            manualTempInputEl.addEventListener('change', (e) => { manualTempVal = e.target.value; updateUI(); });
            thresholdInputEl.addEventListener('change', (e) => { thresholdInputVal = e.target.value; updateUI(); });

            // Start the game
            startGame();

            // 4. Initial Render
            updateUI();
        });

        // Placeholder for navigation buttons
        document.getElementById('prev-btn').addEventListener('click', () => window.history.back());
        document.getElementById('home-btn').addEventListener('click', () => console.log('Navigate to home'));
        document.getElementById('levels-btn').addEventListener('click', () => console.log('Navigate to levels'));
        document.getElementById('next-experiment-btn').addEventListener('click', () => console.log('Navigate to next experiment'));
    </script>
</body>

</html>